---
import { type CollectionEntry } from "astro:content";

import BlogPost from "@components/Blog/BlogPost.astro";
import DefaultLayout from "@layouts/DefaultLayout.astro";
import FullPageLayout from "@layouts/FullPageLayout.astro";

import {
    getAllPosts,
} from '@components/Blog/utils/getAllPosts';

export const prerender = true;

export async function getStaticPaths() {
    const posts = await getAllPosts('blog', 'fr');

    return posts.map((post) => {
        return {
            params: {
                slug: post.slug,
            },
            props: {
                postIndex: post.postIndex,
                post,
                hasTranslation: post.hasTranslation
            },
        };
    });
}

// If set up correctly, The page prop now has everything that
// you need to render a single page (see next section).

interface Props {
    post: CollectionEntry<"blog">;
    hasTranslation: boolean;
    postIndex: number;
}

const { post, postIndex, hasTranslation } = Astro.props;
const { template, title } = post.data;

console.log(hasTranslation)
---

{
  template === "full-page" ? (
    <FullPageLayout title={title}>
      <BlogPost post={post} showBackLink={false} showDate={false} />
    </FullPageLayout>
  ) : (
    <DefaultLayout title={post.data.title} hideTitle>
        <BlogPost post={post} postIndex={postIndex} hasTranslation={hasTranslation} />
    </DefaultLayout>
  )
}
<style>
  .top-nav {
    margin-block-end: 2em;
  }
  body {
    --theme-accent: var(--theme-accent-blue);
  }
</style>