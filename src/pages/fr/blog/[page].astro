---
import type { GetStaticPaths } from "astro";
import type { CollectionEntry } from "astro:content";

import BlogPostPreview from "@components/Blog/BlogPostPreview.astro";
import ArchiveNav from "@components/Global/ArchiveNav.astro";
import DefaultLayout from "@layouts/DefaultLayout.astro";

import { getAllPosts } from "@components/Blog/utils/getAllPosts";

export const getStaticPaths = (async ({ paginate }) => {
    const allPosts = await getAllPosts();

    // Return a paginated collection of paths for all posts
    return paginate(allPosts, { pageSize: 10 });
}) satisfies GetStaticPaths;

interface Props {
    page: {
        currentPage: number;
        data: Array<CollectionEntry<"blog">>;
    };
}

const { page } = Astro.props;

const prevText = "articles plus r√©cents";
const nextText = "articles plus anciens";
---

<DefaultLayout title={`Blog Archive Page ${page.currentPage}`}>
    <div class="top-nav">
        <ArchiveNav page={page} prevText={prevText} nextText={nextText} />
    </div>

    {page.data.map((p) => <BlogPostPreview post={p} postIndex={p.postIndex} />)}

    <ArchiveNav page={page} prevText={prevText} nextText={nextText} />
</DefaultLayout>
<style>
    .top-nav {
        margin-block-end: 2em;
    }
</style>
