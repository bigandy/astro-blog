---
import { render } from "astro:content";

import BlogContent from "@components/Blog/BlogContent.astro";
import BlogPostHeader from "@components/Blog/BlogPostHeader.astro";
import BackArrow from "@components/Global/BackArrow.astro";
import EditPostOnGithub from "@components/Global/EditPostOnGithub.astro";

const {
    post,
    showBackLink = true,
    showDate = true,
    collection = "blog",
    postIndex,
    hasTranslation
} = Astro.props;
const { Content } = await render(post);
// const backTitle = Astro.currentLocale ? "Retour au blog" : "Back to blog";
// const prefix = Astro.currentLocale ? `/${Astro.currentLocale}` : "";
const noTranslation = !hasTranslation && Astro.currentLocale === 'fr';
---

<article class="content post layout-inner">
    {noTranslation && <p class="no-translation">Pas de traduction disponible.</p>}
    <BlogPostHeader
        date={showDate && post.data.date}
        title={post.data.title}
        isPreview={false}
        slug={post.slug}
        viewTransitionName={post.slug}
        postIndex={postIndex}
    />

    <BlogContent>
        <Content />
    </BlogContent>

    {
        showBackLink && (
            <BackArrow
                url={`/${collection}`}
                title={`Back to all ${collection} posts`}
            />
        )
    }
</article>

<EditPostOnGithub slug={post.slug} collection={collection} />

<style>
  .external-link {
    margin-block: 2rem;
    padding-block: 1rem;
  }

  .content :global(main > * + *) {
    margin-block-start: 1rem;
  }

  a {
    margin-bottom: 2rem;
    display: inline-block;

  }
  .post {
    padding: 1rem;
  }

  .no-translation {
    width: 100%;
    padding: 1rem;
    border: 0.25rem dotted red;
    max-width: unset;
    text-align: center;
  }
</style>
