---
import { type CollectionEntry } from "astro:content";

import BlogPost from "@components/Blog/BlogPost.astro";
import DefaultLayout from "@layouts/DefaultLayout.astro";
import FullPageLayout from "@layouts/FullPageLayout.astro";

import { mungePosts } from "@components/Blog/utils/mungePosts";


export const prerender = true;

export async function getStaticPaths() {
  const posts = await mungePosts("fr");

  return posts.map(({ post, hasTranslation }) => {
    return {
      params: {
        slug: post.slug,
      },
      props: {
        post,
        hasTranslation,
      },
    };
  });
}

// If set up correctly, The page prop now has everything that
// you need to render a single page (see next section).

interface Props {
  post: CollectionEntry<"blog">;
  hasTranslation: boolean;
    postIndex: number;
}

const { post, postIndex, hasTranslation } = Astro.props;
const { template, title } = post.data;
---

{
  template === "full-page" ? (
    <FullPageLayout title={title}>
      <BlogPost post={post} showBackLink={false} showDate={false} />
    </FullPageLayout>
  ) : (
    <DefaultLayout title={post.data.title} hideTitle>
        <BlogPost post={post} postIndex={postIndex} hasTranslation={hasTranslation} />
    </DefaultLayout>
  )
}
<style>
  .top-nav {
    margin-block-end: 2em;
  }
  body {
    --theme-accent: var(--theme-accent-blue);
  }
</style>
